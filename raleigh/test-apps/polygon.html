<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="initial-scale=1,maximum-scale=1,user-scalable=no"
    />
    <title>deck.gl layers in MapView</title>

    <link rel="stylesheet" href="https://js.arcgis.com/4.12/esri/themes/light/main.css"/>
    <style>
      html,
      body,
      #viewDiv {
        padding: 0;
        margin: 0;
        height: 100%;
        width: 100%;
      }
    </style>
    
    <!-- Load the ArcGIS Javascript API -->
    <script src="https://js.arcgis.com/4.12/"></script>

    <!-- Load esri-deck.js AFTER loading the ArcGIS Javascript API -->
    <script src="../lib/esri-deck.js"></script>

    <script>
      require([
          "esri/Map",
          "esri/views/MapView",
        ], function(
          Map,
          MapView
        ) {
          var map = new Map({
            basemap: "streets"
          });

          var view = new MapView({
            container: "viewDiv",
            map: map,
            center: [0, 0],
            zoom: 5
          });
          
          esriDeck.ready.then(() => {
            const layer = new esriDeck.EsriDeckLayer({
              getDeckLayer() {
                return new esriDeck.layers.PolygonLayer({
                  id: 'polygon-layer',
                  data: [
                    {
                      contour: [[0.50, 0.50], [-0.50, 0.50], [-0.50, -0.50], [0.50, -0.50], [0.50, 0.50]],
                      zipcode: 94107,
                      population: 26599,
                      area: 6.11
                    }
                  ],
                  pickable: true,
                  stroked: true,
                  filled: true,
                  wireframe: true,
                  lineWidthMinPixels: 1,
                  getPolygon: d => d.contour,
                  getElevation: d => 100,
                  getFillColor: d => [d.population / d.area / 60, 140, 0],
                  getLineColor: [80, 80, 80],
                  getLineWidth: 1
                });
              }
            });

            map.layers.add(layer);
          });
        }
      );
    </script>
  </head>

  <body>
    <div id="viewDiv"></div>
  </body>
</html>
